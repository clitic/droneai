# ğŸ›©ï¸ DroneAI

YOLO26-based object detection for drone / aerial imagery with a Gradio web UI.

Detects **17 classes** across buildings, infrastructure, vehicles, and road elements from top-down drone views.

## Classes

| ID | Class | ID | Class | ID | Class |
|----|-------|----|-------|----|-------|
| 0 | vehicles | 6 | Tree | 12 | Road_Sign |
| 1 | Building | 7 | Under_Construction | 13 | Speed_limit |
| 2 | Door | 8 | Wall | 14 | Street_light |
| 3 | Grass | 9 | Windows | 15 | Traffic_Signal |
| 4 | Roof | 10 | Advertisement | 16 | Zebra_Crossing |
| 5 | Stairs | 11 | Dustbin | | |

## Setup

**Prerequisites:** [uv](https://docs.astral.sh/uv/) and Python 3.14+

```bash
# Clone and install dependencies
git clone <repo-url> && cd droneai
uv sync
```

## Usage

### 1. Prepare Data

Place YOLO26-format datasets in `./data/`, then unify them:

```bash
uv run data.py
```

This merges all datasets into `./data/unified/` with remapped class IDs.

### 2. Train

```bash
uv run train.py
```

| Flag | Default | Description |
|------|---------|-------------|
| `--model` | `yolo26n.pt` | Pretrained model (`yolo26n`, `yolo26s`, `yolo26m`) |
| `--epochs` | `150` | Training epochs (early stopping at 15) |
| `--imgsz` | `640` | Image size |
| `--batch` | `-1` | Batch size (`-1` = auto) |
| `--device` | `0` | `0` for GPU, `cpu` for CPU |
| `--resume` | off | Resume from last checkpoint |

Weights are saved to `./runs/drone_detect/weights/best.pt`.

### 3. Detect (Web UI)

```bash
uv run main.py
```

Opens a Gradio web UI at `http://localhost:7860` with:
- **Image tab** â€” upload an image, adjust confidence, view detections
- **Video tab** â€” upload a video, see per-frame progress, get annotated output

## Project Structure

```
droneai/
â”œâ”€â”€ main.py           # Gradio web UI for detection
â”œâ”€â”€ train.py          # YOLO26 training script
â”œâ”€â”€ data.py           # Dataset unification script
â”œâ”€â”€ pyproject.toml    # Dependencies & config
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ unified/      # Merged dataset (generated by data.py)
â”‚   â””â”€â”€ *.yolo26/     # Raw source datasets
â””â”€â”€ runs/
    â””â”€â”€ drone_detect/ # Training outputs & weights
```

## Tech Stack

- **[YOLO26](https://docs.ultralytics.com)** â€” NMS-free, edge-first object detection
- **[Gradio](https://gradio.app)** â€” Web UI
- **[PyTorch](https://pytorch.org)** â€” With CUDA 12.6 for GPU acceleration
- **[uv](https://docs.astral.sh/uv/)** â€” Package management
